# 网络工具箱 - 使用教程

## 快速开始

### 工作流程

```
生成模板 → SSH采集 → LLDP解析 → 生成配置 → 拓扑可视化
```

---

## 功能模块说明

### 1. 生成模板

生成设备清单Excel模板，用于填写设备信息（名称、IP、用户名、密码等）。

**使用方法：**
1. 点击「生成设备清单模板」
2. 选择保存位置
3. 在Excel中填写设备信息

**模板内容：**
- **设备清单** 工作表：设备名称、厂商、管理IP、用户名、密码、启用状态
- **连线信息** 工作表：本端/对端设备、接口、IP地址等

---

### 2. SSH采集

通过SSH批量连接网络设备，采集LLDP邻居信息。

**使用方法：**
1. 准备设备清单Excel（包含设备名称、IP、用户名、密码、厂商）
2. 选择文件，设置并发数（推荐30-100）
3. 点击「开始执行并发采集」
4. 采集结果保存在 `lldp_data/` 目录

**配置文件位置：**
```
config/lldp_commands.txt
```

**配置文件格式：**
```
[华为]
display lldp neighbor brief
display ip interface brief

[华三]
display lldp neighbor-information list
display ip interface brief

[锐捷]
show lldp neighbors
show ip interface brief
```

---

### 3. LLDP解析

解析采集的配置文件，自动提取设备互联信息，生成Excel布线表。

**使用方法：**
1. 选择配置文件目录（默认为 `lldp_data/`）
2. 点击「开始解析」
3. 生成的布线表保存在 `output/` 目录

**输出文件：**
- 布线表Excel：包含「连线信息」和「设备信息」两个工作表
- 调试文件：JSON格式的解析结果

---

### 4. 生成配置

根据Excel布线表和Jinja2模板，批量生成设备配置文件。

**使用方法：**
1. 选择互联数据Excel文件
2. 选择Jinja2模板目录（默认为 `templates/`）
3. 点击「开始生成配置」
4. 配置文件保存在 `output/` 目录

**模板文件位置：**
```
templates/华三.txt
templates/华为.txt
templates/锐捷.txt
```

**模板变量说明：**
- `{{ device_info.设备名称 }}` - 设备名称
- `{{ device_info.厂商 }}` - 厂商名称
- `{% for intf in interfaces %}` - 遍历所有接口

---

### 5. PDF拓扑

根据Excel布线表生成PDF格式的网络拓扑图。

**依赖要求：**
- 需要安装 [Graphviz](https://graphviz.org/download/) 软件

**使用方法：**
1. 选择互联表Excel文件
2. 点击「生成PDF拓扑图」
3. PDF文件保存在 `output/graphs/` 目录

**设备分层规则：**
| 设备名称包含 | 层级 | 颜色 |
|-------------|------|------|
| WER | 最高层 | 红色 |
| WBS | 第二层 | 黄色 |
| WDS | 第三层 | 绿色 |
| WAS | 最低层 | 蓝色 |

---

### 6. HTML拓扑

生成可交互的HTML网络拓扑图，支持缩放、筛选、搜索。

**使用方法：**
1. 选择互联表Excel文件
2. 点击「生成HTML拓扑图」
3. HTML文件保存在 `output/graphs/` 目录
4. 可直接在浏览器中打开

**交互功能：**
- 鼠标拖拽移动节点
- 滚轮缩放视图
- 搜索框查找设备
- 筛选按钮过滤显示

---

## 自定义配置

### 修改采集命令

编辑 `config/lldp_commands.txt` 文件，按厂商添加需要采集的命令。

### 修改配置模板

编辑 `templates/` 目录下的模板文件，支持Jinja2语法。

### 修改教程内容

编辑 `tutorial.md` 文件（Markdown格式），保存后点击刷新即可看到更新。

---

## 常见问题

**Q: SSH采集失败怎么办？**
- 检查设备IP是否可达
- 确认用户名密码正确
- 查看是否需要通过代理连接

**Q: LLDP解析不出数据？**
- 确认配置文件格式正确
- 检查设备是否支持LLDP协议
- 查看debug文件了解解析详情

**Q: 配置生成失败？**
- 确认Excel中有设备信息工作表
- 检查模板文件是否存在
- 确认设备名称与模板厂商匹配

---

## 技术支持

如有问题，请检查日志文件或联系开发人员。
